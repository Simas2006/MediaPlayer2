<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>MediaPlayer2</title>
  <link rel="stylesheet" type="text/css" href="style.css" />
  <script>
    var fs = require("fs");
    var ip = require("ip");
    var LOCAL_DIR = process.env.APPDATA || (process.platform == "darwin" ? process.env.HOME + "/Library/Application Support/MediaPlayer2" : "/var/local");
    function createPassword() {
      var password = document.getElementById("password").value;
      fs.writeFile(LOCAL_DIR + "/ServerPassword",password,function(err) {
        if ( err ) throw err;
        fs.mkdir(LOCAL_DIR + "/LocalData",function(err) {
          if ( err && err.code != "EEXIST" ) throw err;
          fs.mkdir(LOCAL_DIR + "/LocalData/photos",function(err) {
            if ( err && err.code != "EEXIST" ) throw err;
            fs.mkdir(LOCAL_DIR + "/LocalData/music",function(err) {
              if ( err && err.code != "EEXIST" ) throw err;
              fs.mkdir(LOCAL_DIR + "/ServerData",function(err) {
                if ( err && err.code != "EEXIST" ) throw err;
                location.href = __dirname + "/index.html";
              });
            });
          });
        });
      });
    }
    window.onload = function() {
      var addr = ip.address().split(".");
      document.getElementById("serverID").innerText = "Your Server ID: " + addr[addr.length - 1];
    }
  </script>
</head>
<body>
  <div class="centerPanel">
    <h1>MediaPlayer2</h1>
    <hr />
    <p>
      Welcome to MediaPlayer2!<br />
      Please create a password to be used to login to the app.<br /><br />
      <input type="password" id="password" placeholder="Password" onchange="createPassword()" /><br /><br />
      <span id="serverID"></span>
    </p>
  </div>
</body>
</html>
